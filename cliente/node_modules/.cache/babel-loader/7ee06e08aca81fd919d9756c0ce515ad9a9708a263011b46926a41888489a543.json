{"ast":null,"code":"var _jsxFileName = \"/home/eliezer/Projetos/globo-teste-tecnico/client/client/src/components/AddMovieComponent.jsx\";\nimport React from \"react\";\nimport FormComponent from \"./common/FormComponent\";\nimport { movieSchema } from \"../util/JoiSchema\";\nimport InputFieldComponent from \"./common/InputFieldComponent\";\nimport { getGenres, getLanguages } from \"../services/movies\";\nimport { isJsonObjEmpty } from \"../util/utils\";\nimport { addMovie } from \"./../services/movies\";\nimport { ALERT_MESSAGE_IMAGE } from \"./../util/constants\";\nimport { getTokenFromCookie, decodeToken as isUserAuthenticated } from \"./../util/authentication\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass AddMovieComponent extends FormComponent {\n  constructor() {\n    var _this;\n    super(...arguments);\n    _this = this;\n    this.state = {\n      data: {\n        name: \"\",\n        releaseYear: \"\",\n        genreId: \"\",\n        languageId: \"\",\n        story: \"\"\n      },\n      image: {\n        value: null,\n        errorMsg: undefined,\n        uploaded: false\n      },\n      errors: {},\n      genres: [],\n      languages: []\n    };\n    this.schema = movieSchema;\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const {\n        data,\n        image\n      } = this.state;\n      const {\n        user\n      } = this.props;\n      await this.validateInput(data, this.schema);\n      if (isJsonObjEmpty(this.state.errors) && image.uploaded) {\n        this.props.toggleLoaderDisplay();\n        const response = await addMovie(data, image.value, user);\n        this.props.toggleLoaderDisplay();\n        if (200 === response.status) this.props.history.push(\"/movies\");else this.props.history.push(\"/login\");\n      } else if (!image.uploaded) {\n        this.updateImageState(false, ALERT_MESSAGE_IMAGE);\n      }\n    };\n    this.handleImageValidation = e => {\n      e.preventDefault();\n      const img = e.target.files[0];\n      if (!(\"image/jpeg\" === img.type) || 48000 < img.size) this.updateImageState(false, ALERT_MESSAGE_IMAGE);else this.updateImageState(true, undefined, img);\n    };\n    this.updateImageState = function (uploaded, errorMsg) {\n      let value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      let image = {\n        ..._this.state.image\n      };\n      image = uploaded ? {\n        value,\n        uploaded,\n        errorMsg: undefined\n      } : {\n        value: undefined,\n        uploaded,\n        errorMsg\n      };\n      _this.setState({\n        image\n      });\n    };\n  }\n  async componentDidMount() {\n    if (isUserAuthenticated()) {\n      this.props.toggleLoaderDisplay();\n      const genres = await getGenres();\n      const languages = await getLanguages();\n      this.setState({\n        genres,\n        languages\n      });\n      this.props.toggleLoaderDisplay();\n    } else this.props.history.push(\"/login\");\n  }\n  render() {\n    const {\n      data,\n      errors,\n      genres,\n      languages,\n      image\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Add a Movie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(InputFieldComponent, {\n          type: \"text\",\n          value: data[\"name\"],\n          error: errors[\"name\"],\n          onChange: this.handleChange,\n          name: \"name\",\n          label: \"Movie\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InputFieldComponent, {\n          type: \"yearly-calendar\",\n          value: data[\"releaseYear\"],\n          error: errors[\"releaseYear\"],\n          onChange: this.handleChange,\n          name: \"releaseYear\",\n          label: \"Release Year\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InputFieldComponent, {\n          type: \"drop-down\",\n          value: data[\"genreId\"],\n          error: errors[\"genreId\"],\n          onChange: this.handleChange,\n          name: \"genreId\",\n          label: \"Genre\",\n          list: genres\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InputFieldComponent, {\n          type: \"drop-down\",\n          value: data[\"languageId\"],\n          error: errors[\"languageId\"],\n          onChange: this.handleChange,\n          name: \"languageId\",\n          label: \"Languages\",\n          list: languages\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InputFieldComponent, {\n          type: \"textarea\",\n          value: data[\"story\"],\n          error: errors[\"story\"],\n          onChange: this.handleChange,\n          name: \"story\",\n          label: \"Plot\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InputFieldComponent, {\n          type: \"upload\",\n          value: image[\"value\"],\n          error: image[\"errorMsg\"],\n          onChange: this.handleImageValidation,\n          name: \"image\",\n          label: \"Poster\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-secondary btn-sm\",\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this);\n  }\n}\nexport default AddMovieComponent;","map":{"version":3,"names":["React","FormComponent","movieSchema","InputFieldComponent","getGenres","getLanguages","isJsonObjEmpty","addMovie","ALERT_MESSAGE_IMAGE","getTokenFromCookie","decodeToken","isUserAuthenticated","AddMovieComponent","state","data","name","releaseYear","genreId","languageId","story","image","value","errorMsg","undefined","uploaded","errors","genres","languages","schema","handleSubmit","e","preventDefault","user","props","validateInput","toggleLoaderDisplay","response","status","history","push","updateImageState","handleImageValidation","img","target","files","type","size","setState","componentDidMount","render","handleChange"],"sources":["/home/eliezer/Projetos/globo-teste-tecnico/client/client/src/components/AddMovieComponent.jsx"],"sourcesContent":["import React from \"react\";\nimport FormComponent from \"./common/FormComponent\";\nimport { movieSchema } from \"../util/JoiSchema\";\nimport InputFieldComponent from \"./common/InputFieldComponent\";\nimport { getGenres, getLanguages } from \"../services/movies\";\nimport { isJsonObjEmpty } from \"../util/utils\";\nimport { addMovie } from \"./../services/movies\";\nimport { ALERT_MESSAGE_IMAGE } from \"./../util/constants\";\nimport {\n  getTokenFromCookie,\n  decodeToken as isUserAuthenticated\n} from \"./../util/authentication\";\n\nclass AddMovieComponent extends FormComponent {\n  state = {\n    data: {\n      name: \"\",\n      releaseYear: \"\",\n      genreId: \"\",\n      languageId: \"\",\n      story: \"\"\n    },\n    image: {\n      value: null,\n      errorMsg: undefined,\n      uploaded: false\n    },\n    errors: {},\n    genres: [],\n    languages: []\n  };\n\n  async componentDidMount() {\n    if (isUserAuthenticated()) {\n      this.props.toggleLoaderDisplay();\n      const genres = await getGenres();\n      const languages = await getLanguages();\n      this.setState({ genres, languages });\n      this.props.toggleLoaderDisplay();\n    } else this.props.history.push(\"/login\");\n  }\n\n  schema = movieSchema;\n\n  handleSubmit = async e => {\n    e.preventDefault();\n    const { data, image } = this.state;\n    const { user } = this.props;\n    await this.validateInput(data, this.schema);\n\n    if (isJsonObjEmpty(this.state.errors) && image.uploaded) {\n      this.props.toggleLoaderDisplay();\n      const response = await addMovie(data, image.value, user);\n      this.props.toggleLoaderDisplay();\n      if (200 === response.status) this.props.history.push(\"/movies\");\n      else this.props.history.push(\"/login\");\n    } else if (!image.uploaded) {\n      this.updateImageState(false, ALERT_MESSAGE_IMAGE);\n    }\n  };\n\n  handleImageValidation = e => {\n    e.preventDefault();\n    const img = e.target.files[0];\n\n    if (!(\"image/jpeg\" === img.type) || 48000 < img.size)\n      this.updateImageState(false, ALERT_MESSAGE_IMAGE);\n    else this.updateImageState(true, undefined, img);\n  };\n\n  updateImageState = (uploaded, errorMsg, value = null) => {\n    let image = { ...this.state.image };\n    image = uploaded\n      ? { value, uploaded, errorMsg: undefined }\n      : { value: undefined, uploaded, errorMsg };\n    this.setState({ image });\n  };\n\n  render() {\n    const { data, errors, genres, languages, image } = this.state;\n\n    return (\n      <div>\n        <h1>Add a Movie</h1>\n        <form onSubmit={this.handleSubmit}>\n          <InputFieldComponent\n            type=\"text\"\n            value={data[\"name\"]}\n            error={errors[\"name\"]}\n            onChange={this.handleChange}\n            name=\"name\"\n            label=\"Movie\"\n          />\n\n          <InputFieldComponent\n            type=\"yearly-calendar\"\n            value={data[\"releaseYear\"]}\n            error={errors[\"releaseYear\"]}\n            onChange={this.handleChange}\n            name=\"releaseYear\"\n            label=\"Release Year\"\n          />\n\n          <InputFieldComponent\n            type=\"drop-down\"\n            value={data[\"genreId\"]}\n            error={errors[\"genreId\"]}\n            onChange={this.handleChange}\n            name=\"genreId\"\n            label=\"Genre\"\n            list={genres}\n          />\n\n          <InputFieldComponent\n            type=\"drop-down\"\n            value={data[\"languageId\"]}\n            error={errors[\"languageId\"]}\n            onChange={this.handleChange}\n            name=\"languageId\"\n            label=\"Languages\"\n            list={languages}\n          />\n\n          <InputFieldComponent\n            type=\"textarea\"\n            value={data[\"story\"]}\n            error={errors[\"story\"]}\n            onChange={this.handleChange}\n            name=\"story\"\n            label=\"Plot\"\n          />\n\n          <InputFieldComponent\n            type=\"upload\"\n            value={image[\"value\"]}\n            error={image[\"errorMsg\"]}\n            onChange={this.handleImageValidation}\n            name=\"image\"\n            label=\"Poster\"\n          />\n\n          <button className=\"btn btn-secondary btn-sm\">Submit</button>\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default AddMovieComponent;"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,aAAa,MAAM,wBAAwB;AAClD,SAASC,WAAW,QAAQ,mBAAmB;AAC/C,OAAOC,mBAAmB,MAAM,8BAA8B;AAC9D,SAASC,SAAS,EAAEC,YAAY,QAAQ,oBAAoB;AAC5D,SAASC,cAAc,QAAQ,eAAe;AAC9C,SAASC,QAAQ,QAAQ,sBAAsB;AAC/C,SAASC,mBAAmB,QAAQ,qBAAqB;AACzD,SACEC,kBAAkB,EAClBC,WAAW,IAAIC,mBAAmB,QAC7B,0BAA0B;AAAC;AAElC,MAAMC,iBAAiB,SAASX,aAAa,CAAC;EAAA;IAAA;IAAA;IAAA;IAAA,KAC5CY,KAAK,GAAG;MACNC,IAAI,EAAE;QACJC,IAAI,EAAE,EAAE;QACRC,WAAW,EAAE,EAAE;QACfC,OAAO,EAAE,EAAE;QACXC,UAAU,EAAE,EAAE;QACdC,KAAK,EAAE;MACT,CAAC;MACDC,KAAK,EAAE;QACLC,KAAK,EAAE,IAAI;QACXC,QAAQ,EAAEC,SAAS;QACnBC,QAAQ,EAAE;MACZ,CAAC;MACDC,MAAM,EAAE,CAAC,CAAC;MACVC,MAAM,EAAE,EAAE;MACVC,SAAS,EAAE;IACb,CAAC;IAAA,KAYDC,MAAM,GAAG1B,WAAW;IAAA,KAEpB2B,YAAY,GAAG,MAAMC,CAAC,IAAI;MACxBA,CAAC,CAACC,cAAc,EAAE;MAClB,MAAM;QAAEjB,IAAI;QAAEM;MAAM,CAAC,GAAG,IAAI,CAACP,KAAK;MAClC,MAAM;QAAEmB;MAAK,CAAC,GAAG,IAAI,CAACC,KAAK;MAC3B,MAAM,IAAI,CAACC,aAAa,CAACpB,IAAI,EAAE,IAAI,CAACc,MAAM,CAAC;MAE3C,IAAItB,cAAc,CAAC,IAAI,CAACO,KAAK,CAACY,MAAM,CAAC,IAAIL,KAAK,CAACI,QAAQ,EAAE;QACvD,IAAI,CAACS,KAAK,CAACE,mBAAmB,EAAE;QAChC,MAAMC,QAAQ,GAAG,MAAM7B,QAAQ,CAACO,IAAI,EAAEM,KAAK,CAACC,KAAK,EAAEW,IAAI,CAAC;QACxD,IAAI,CAACC,KAAK,CAACE,mBAAmB,EAAE;QAChC,IAAI,GAAG,KAAKC,QAAQ,CAACC,MAAM,EAAE,IAAI,CAACJ,KAAK,CAACK,OAAO,CAACC,IAAI,CAAC,SAAS,CAAC,CAAC,KAC3D,IAAI,CAACN,KAAK,CAACK,OAAO,CAACC,IAAI,CAAC,QAAQ,CAAC;MACxC,CAAC,MAAM,IAAI,CAACnB,KAAK,CAACI,QAAQ,EAAE;QAC1B,IAAI,CAACgB,gBAAgB,CAAC,KAAK,EAAEhC,mBAAmB,CAAC;MACnD;IACF,CAAC;IAAA,KAEDiC,qBAAqB,GAAGX,CAAC,IAAI;MAC3BA,CAAC,CAACC,cAAc,EAAE;MAClB,MAAMW,GAAG,GAAGZ,CAAC,CAACa,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAE7B,IAAI,EAAE,YAAY,KAAKF,GAAG,CAACG,IAAI,CAAC,IAAI,KAAK,GAAGH,GAAG,CAACI,IAAI,EAClD,IAAI,CAACN,gBAAgB,CAAC,KAAK,EAAEhC,mBAAmB,CAAC,CAAC,KAC/C,IAAI,CAACgC,gBAAgB,CAAC,IAAI,EAAEjB,SAAS,EAAEmB,GAAG,CAAC;IAClD,CAAC;IAAA,KAEDF,gBAAgB,GAAG,UAAChB,QAAQ,EAAEF,QAAQ,EAAmB;MAAA,IAAjBD,KAAK,uEAAG,IAAI;MAClD,IAAID,KAAK,GAAG;QAAE,GAAG,KAAI,CAACP,KAAK,CAACO;MAAM,CAAC;MACnCA,KAAK,GAAGI,QAAQ,GACZ;QAAEH,KAAK;QAAEG,QAAQ;QAAEF,QAAQ,EAAEC;MAAU,CAAC,GACxC;QAAEF,KAAK,EAAEE,SAAS;QAAEC,QAAQ;QAAEF;MAAS,CAAC;MAC5C,KAAI,CAACyB,QAAQ,CAAC;QAAE3B;MAAM,CAAC,CAAC;IAC1B,CAAC;EAAA;EA5CD,MAAM4B,iBAAiB,GAAG;IACxB,IAAIrC,mBAAmB,EAAE,EAAE;MACzB,IAAI,CAACsB,KAAK,CAACE,mBAAmB,EAAE;MAChC,MAAMT,MAAM,GAAG,MAAMtB,SAAS,EAAE;MAChC,MAAMuB,SAAS,GAAG,MAAMtB,YAAY,EAAE;MACtC,IAAI,CAAC0C,QAAQ,CAAC;QAAErB,MAAM;QAAEC;MAAU,CAAC,CAAC;MACpC,IAAI,CAACM,KAAK,CAACE,mBAAmB,EAAE;IAClC,CAAC,MAAM,IAAI,CAACF,KAAK,CAACK,OAAO,CAACC,IAAI,CAAC,QAAQ,CAAC;EAC1C;EAsCAU,MAAM,GAAG;IACP,MAAM;MAAEnC,IAAI;MAAEW,MAAM;MAAEC,MAAM;MAAEC,SAAS;MAAEP;IAAM,CAAC,GAAG,IAAI,CAACP,KAAK;IAE7D,oBACE;MAAA,wBACE;QAAA,UAAI;MAAW;QAAA;QAAA;QAAA;MAAA,QAAK,eACpB;QAAM,QAAQ,EAAE,IAAI,CAACgB,YAAa;QAAA,wBAChC,QAAC,mBAAmB;UAClB,IAAI,EAAC,MAAM;UACX,KAAK,EAAEf,IAAI,CAAC,MAAM,CAAE;UACpB,KAAK,EAAEW,MAAM,CAAC,MAAM,CAAE;UACtB,QAAQ,EAAE,IAAI,CAACyB,YAAa;UAC5B,IAAI,EAAC,MAAM;UACX,KAAK,EAAC;QAAO;UAAA;UAAA;UAAA;QAAA,QACb,eAEF,QAAC,mBAAmB;UAClB,IAAI,EAAC,iBAAiB;UACtB,KAAK,EAAEpC,IAAI,CAAC,aAAa,CAAE;UAC3B,KAAK,EAAEW,MAAM,CAAC,aAAa,CAAE;UAC7B,QAAQ,EAAE,IAAI,CAACyB,YAAa;UAC5B,IAAI,EAAC,aAAa;UAClB,KAAK,EAAC;QAAc;UAAA;UAAA;UAAA;QAAA,QACpB,eAEF,QAAC,mBAAmB;UAClB,IAAI,EAAC,WAAW;UAChB,KAAK,EAAEpC,IAAI,CAAC,SAAS,CAAE;UACvB,KAAK,EAAEW,MAAM,CAAC,SAAS,CAAE;UACzB,QAAQ,EAAE,IAAI,CAACyB,YAAa;UAC5B,IAAI,EAAC,SAAS;UACd,KAAK,EAAC,OAAO;UACb,IAAI,EAAExB;QAAO;UAAA;UAAA;UAAA;QAAA,QACb,eAEF,QAAC,mBAAmB;UAClB,IAAI,EAAC,WAAW;UAChB,KAAK,EAAEZ,IAAI,CAAC,YAAY,CAAE;UAC1B,KAAK,EAAEW,MAAM,CAAC,YAAY,CAAE;UAC5B,QAAQ,EAAE,IAAI,CAACyB,YAAa;UAC5B,IAAI,EAAC,YAAY;UACjB,KAAK,EAAC,WAAW;UACjB,IAAI,EAAEvB;QAAU;UAAA;UAAA;UAAA;QAAA,QAChB,eAEF,QAAC,mBAAmB;UAClB,IAAI,EAAC,UAAU;UACf,KAAK,EAAEb,IAAI,CAAC,OAAO,CAAE;UACrB,KAAK,EAAEW,MAAM,CAAC,OAAO,CAAE;UACvB,QAAQ,EAAE,IAAI,CAACyB,YAAa;UAC5B,IAAI,EAAC,OAAO;UACZ,KAAK,EAAC;QAAM;UAAA;UAAA;UAAA;QAAA,QACZ,eAEF,QAAC,mBAAmB;UAClB,IAAI,EAAC,QAAQ;UACb,KAAK,EAAE9B,KAAK,CAAC,OAAO,CAAE;UACtB,KAAK,EAAEA,KAAK,CAAC,UAAU,CAAE;UACzB,QAAQ,EAAE,IAAI,CAACqB,qBAAsB;UACrC,IAAI,EAAC,OAAO;UACZ,KAAK,EAAC;QAAQ;UAAA;UAAA;UAAA;QAAA,QACd,eAEF;UAAQ,SAAS,EAAC,0BAA0B;UAAA,UAAC;QAAM;UAAA;UAAA;UAAA;QAAA,QAAS;MAAA;QAAA;QAAA;QAAA;MAAA,QACvD;IAAA;MAAA;MAAA;MAAA;IAAA,QACH;EAEV;AACF;AAEA,eAAe7B,iBAAiB"},"metadata":{},"sourceType":"module","externalDependencies":[]}